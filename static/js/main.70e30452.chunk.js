(this["webpackJsonpfood-app"]=this["webpackJsonpfood-app"]||[]).push([[0],{11:function(e,t,n){e.exports={auth:"AuthForm_auth__1kjIZ",control:"AuthForm_control__296nY",actions:"AuthForm_actions__1nvzw",toggle:"AuthForm_toggle__LNBp9"}},14:function(e,t,n){e.exports={item:"RecipeItem_item__1CUn3",image:"RecipeItem_image__1R91R",content:"RecipeItem_content__1ERes",actions:"RecipeItem_actions__vLzMH"}},15:function(e,t,n){e.exports={form:"ProfileForm_form__3UpMA",control:"ProfileForm_control__8hAvn",action:"ProfileForm_action__EKgqZ"}},18:function(e,t,n){e.exports={header:"MainNavigation_header__36YIR",logo:"MainNavigation_logo__3B0gV"}},21:function(e,t,n){e.exports={starting:"StartingPageContent_starting__3hyan",loading:"StartingPageContent_loading__2npxg"}},26:function(e,t,n){e.exports={card:"Card_card__2UOiX"}},27:function(e,t,n){e.exports={list:"RecipesList_list__LE-wY"}},28:function(e,t,n){e.exports={profile:"UserProfile_profile__24tvt"}},38:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var c,i=n(22),o=n.n(i),r=n(8),a=n(4),s=n(1),l=n.n(s),j=n(0),d=l.a.createContext({token:"",localId:"",isLoggedIn:!1,login:function(e){},logout:function(){}}),u=function(e){var t=(new Date).getTime();return new Date(e).getTime()-t},b=function(e){var t,n=function(){var e=localStorage.getItem("token"),t=localStorage.getItem("expirationTime"),n=u(t);return n<=3600?(localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),null):{token:e,duration:n}}();n&&(t=n.token);var i,o={localId:localStorage.getItem("localId")};o&&(i=o.localId);var r=Object(s.useState)(t),l=Object(a.a)(r,2),b=l[0],h=l[1],O=Object(s.useState)(i),p=Object(a.a)(O,2),f=p[0],m=p[1],x=!!b,g=Object(s.useCallback)((function(){h(null),localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),c&&clearTimeout(c)}),[]);Object(s.useEffect)((function(){n&&(c=setTimeout(g,n.duration))}),[n,g]);var v={token:b,localId:f,isLoggedIn:x,login:function(e,t,n){h(e),m(n),localStorage.setItem("token",e),localStorage.setItem("localId",n),localStorage.setItem("expirationTime",t);var i=u(t);c=setTimeout(g,i)},logout:g};return Object(j.jsx)(d.Provider,{value:v,children:e.children})},h=d,O=(n(38),n(2)),p=n.p+"static/media/logo.09d18962.png",f=n(18),m=n.n(f),x=function(){var e=Object(s.useContext)(h),t=Object(O.g)(),n=e.isLoggedIn;return Object(j.jsxs)("header",{className:m.a.header,children:[Object(j.jsx)(r.b,{to:"/",children:Object(j.jsx)("div",{className:m.a.logo,children:Object(j.jsx)("img",{src:p,width:"120px"})})}),Object(j.jsx)("nav",{children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(r.b,{to:"/",children:"Home"})}),!n&&Object(j.jsx)("li",{children:Object(j.jsx)(r.b,{to:"/auth",children:"Login"})}),n&&Object(j.jsx)("li",{children:Object(j.jsx)(r.b,{to:"/profile",children:"Profilo"})}),n&&Object(j.jsx)("li",{children:Object(j.jsx)(r.b,{to:"/add-recipe",children:"Aggiungi Ricetta"})}),n&&Object(j.jsx)("li",{children:Object(j.jsx)("button",{onClick:function(){e.logout(),t.replace("/")},children:"Logout"})})]})})]})},g=function(e){return Object(j.jsxs)(s.Fragment,{children:[Object(j.jsx)(x,{}),Object(j.jsx)("main",{children:e.children})]})},v=n(15),_=n.n(v),I=function(){var e=Object(s.useRef)(),t=Object(s.useContext)(h),n=Object(s.useState)(!1),c=Object(a.a)(n,2),i=c[0],o=c[1];return Object(j.jsxs)("form",{className:_.a.form,onSubmit:function(n){n.preventDefault();var c=e.current.value;fetch("https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyDtH_Q1jBKRe0HM0TuDs2T9eiGvgHq0BII",{method:"POST",body:JSON.stringify({idToken:t.token,password:c,returnSecureToken:!1}),headers:{"Content-Type":"application/json"}}).then((function(e){e.ok&&o(!0)})),o(!1)},children:[Object(j.jsxs)("div",{className:_.a.control,children:[Object(j.jsx)("label",{htmlFor:"new-password",children:"Nuova password"}),Object(j.jsx)("input",{type:"password",id:"new-password",minLength:"7",ref:e})]}),Object(j.jsxs)("div",{className:_.a.action,children:[Object(j.jsx)("button",{children:"Cambia la password"}),i&&Object(j.jsx)("p",{children:"Password cambiata con successo!"})]})]})},S=n(13),N=(n(25),n(20),n(26)),R=n.n(N);var k=function(e){return Object(j.jsx)("div",{className:R.a.card,children:e.children})},w=n(14),T=n.n(w);var y=function(e){var t=Object(s.useContext)(h);return Object(j.jsx)("div",{children:Object(j.jsx)("li",{className:T.a.item,children:Object(j.jsxs)(k,{children:[Object(j.jsx)("div",{className:T.a.image,children:Object(j.jsx)("img",{src:e.image,alt:e.title})}),Object(j.jsxs)("div",{className:T.a.content,children:[Object(j.jsx)("h3",{children:e.title}),Object(j.jsx)("p",{children:e.description})]}),t.isLoggedIn&&"/profile"===window.location.pathname&&Object(j.jsx)("div",{className:T.a.actions,children:Object(j.jsx)("button",{onClick:function(){return t=e.id,void fetch("\n        https://food-app-e237c-default-rtdb.firebaseio.com/recipes/".concat(t,".json"),{method:"DELETE"}).then((function(t){t.json().then((function(t){console.log("reFreshSign",e.reFreshSign),e.getRefresh(!e.reFreshSign)}))}));var t},children:"Elimina"})})]})})})},C=n(27),F=n.n(C);var L=function(e){return Object(j.jsx)("ul",{className:F.a.list,children:e.recipes.map((function(t){return Object(j.jsx)(y,{id:t.id,localId:t.localId,title:t.title,image:t.image,description:t.description,getRefresh:e.getRefresh,reFreshSign:e.reFreshSign},t.key)}))})},A=function(){var e=Object(s.useState)(!0),t=Object(a.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)(!1),o=Object(a.a)(i,2),r=o[0],l=o[1],d=Object(s.useState)([]),u=Object(a.a)(d,2),b=u[0],O=u[1],p=Object(s.useContext)(h);return Object(s.useEffect)((function(){c(!0),fetch("https://food-app-e237c-default-rtdb.firebaseio.com/recipes.json").then((function(e){return e.json()})).then((function(e){var t=[];for(var n in e){var i=Object(S.a)({id:n},e[n]);p.localId===i.localId&&t.push(i)}c(!1),O(t)}))}),[r]),n?Object(j.jsx)("section",{children:Object(j.jsx)("p",{children:"Caricamento.."})}):Object(j.jsxs)("section",{children:[Object(j.jsx)("h1",{children:"Le tue ricette"}),n?null:Object(j.jsx)(L,{recipes:b,reFreshSign:r,getRefresh:function(e){l(e)}})]})},D=n(28),P=n.n(D),E=function(){return Object(j.jsxs)("section",{className:P.a.profile,children:[Object(j.jsx)("h1",{children:"Il tuo profilo"}),Object(j.jsx)(I,{}),Object(j.jsx)(A,{})]})},H=n(11),B=n.n(H),q=function(){var e=Object(O.g)(),t=Object(s.useRef)(),n=Object(s.useRef)(),c=Object(s.useContext)(h),i=Object(s.useState)(!0),o=Object(a.a)(i,2),r=o[0],l=o[1],d=Object(s.useState)(!1),u=Object(a.a)(d,2),b=u[0],p=u[1];return Object(j.jsxs)("section",{className:B.a.auth,children:[Object(j.jsx)("h1",{children:r?"Login":"Registrati"}),Object(j.jsxs)("form",{onSubmit:function(i){i.preventDefault();var o,a=t.current.value,s=n.current.value;p(!0),o=r?"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDtH_Q1jBKRe0HM0TuDs2T9eiGvgHq0BII":"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDtH_Q1jBKRe0HM0TuDs2T9eiGvgHq0BII",fetch(o,{method:"POST",body:JSON.stringify({email:a,password:s,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((function(e){return p(!1),e.ok?e.json():e.json().then((function(e){throw new Error("Autenticazione fallita!")}))})).then((function(t){var n=new Date((new Date).getTime()+1e3*+t.expiresIn);c.login(t.idToken,n.toISOString(),t.localId),e.replace("/")})).catch((function(e){alert(e.message)}))},children:[Object(j.jsxs)("div",{className:B.a.control,children:[Object(j.jsx)("label",{htmlFor:"email",children:"La tua email"}),Object(j.jsx)("input",{type:"email",id:"email",required:!0,ref:t})]}),Object(j.jsxs)("div",{className:B.a.control,children:[Object(j.jsx)("label",{htmlFor:"password",children:"La tua password"}),Object(j.jsx)("input",{type:"password",id:"password",required:!0,ref:n})]}),Object(j.jsxs)("div",{className:B.a.actions,children:[!b&&Object(j.jsx)("button",{children:r?"Login":"Crea Account"}),b&&Object(j.jsx)("p",{children:"Sto inviando le informazioni.."}),Object(j.jsx)("button",{type:"button",className:B.a.toggle,onClick:function(){l((function(e){return!e}))},children:r?"Crea un nuovo account":"Login con un profilo esistente"})]})]})]})},M=function(){return Object(j.jsx)(q,{})},z=n(21),J=n.n(z),K=function(){var e=Object(s.useState)(!0),t=Object(a.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)([]),o=Object(a.a)(i,2),r=o[0],l=o[1];return Object(s.useEffect)((function(){c(!0),fetch("https://food-app-e237c-default-rtdb.firebaseio.com/recipes.json").then((function(e){return e.json()})).then((function(e){var t=[];for(var n in e){var i=Object(S.a)({id:n},e[n]);t.push(i)}c(!1),l(t)}))}),[]),n?Object(j.jsx)("section",{children:Object(j.jsx)("p",{className:J.a.loading,children:"Caricamento.."})}):Object(j.jsxs)("section",{className:J.a.starting,children:[Object(j.jsx)("h1",{children:"Tutte le ricette"}),Object(j.jsx)(L,{recipes:r})]})},U=function(){return Object(j.jsx)(K,{})},G=n(9),Q=n.n(G);var Y=function(e){var t=Object(s.useRef)(),n=Object(s.useRef)(),c=Object(s.useRef)(),i=Object(s.useContext)(h);return Object(j.jsxs)("section",{className:Q.a.starting,children:[Object(j.jsx)("h1",{children:"Aggiungi una ricetta"}),Object(j.jsxs)("form",{className:Q.a.form,onSubmit:function(o){o.preventDefault();var r=t.current.value,a=n.current.value,s=c.current.value,l={localId:i.localId,title:r,image:a,description:s};e.onAddRecipe(l)},children:[Object(j.jsxs)("div",{className:Q.a.control,children:[Object(j.jsx)("label",{className:Q.a.control,children:"Titolo"}),Object(j.jsx)("input",{type:"text",id:"title-recipe",required:!0,ref:t})]}),Object(j.jsxs)("div",{className:Q.a.control,children:[Object(j.jsx)("label",{children:"Immagine"}),Object(j.jsx)("input",{type:"url",id:"image-recipe",required:!0,ref:n})]}),Object(j.jsxs)("div",{className:Q.a.control,children:[Object(j.jsx)("label",{children:"Procedimento"}),Object(j.jsx)("textarea",{id:"description-recipe",required:!0,rows:"7",ref:c})]}),Object(j.jsx)("div",{className:Q.a.actions,children:Object(j.jsx)("button",{children:"Aggiungi Ricetta"})})]})]})},Z=function(){var e=Object(O.g)();return Object(j.jsx)(Y,{onAddRecipe:function(t){fetch("https://food-app-e237c-default-rtdb.firebaseio.com/recipes.json",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(){e.replace("/")}))}})};var V=function(){var e=Object(s.useContext)(h);return Object(j.jsx)(g,{children:Object(j.jsxs)(O.d,{children:[Object(j.jsx)(O.b,{path:"/",exact:!0,children:Object(j.jsx)(U,{})}),!e.isLoggedIn&&Object(j.jsx)(O.b,{path:"/auth",children:Object(j.jsx)(M,{})}),e.isLoggedIn&&Object(j.jsx)(O.b,{path:"/profile",children:Object(j.jsx)(E,{})}),e.isLoggedIn&&Object(j.jsx)(O.b,{path:"/add-recipe",children:Object(j.jsx)(Z,{})}),Object(j.jsx)(O.b,{path:"*",children:Object(j.jsx)(O.a,{to:"/"})})]})})};o.a.createRoot(document.getElementById("root")).render(Object(j.jsx)(b,{children:Object(j.jsx)(r.a,{children:Object(j.jsx)(V,{})})}))},9:function(e,t,n){e.exports={starting:"RecipeForm_starting__2HMge",form:"RecipeForm_form__3tfZM",control:"RecipeForm_control__3ys0D",actions:"RecipeForm_actions__2BxKd"}}},[[47,1,2]]]);
//# sourceMappingURL=main.70e30452.chunk.js.map